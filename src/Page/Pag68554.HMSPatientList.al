#pragma warning disable AA0005, AA0008, AA0018, AA0021, AA0072, AA0137, AA0201, AA0204, AA0206, AA0218, AA0228, AL0254, AL0424, AS0011, AW0006 // ForNAV settings
Page 68554 "HMS-Patient List"
{
    CardPageID = "HMS Patient Student Card";
    DeleteAllowed = false;
    PageType = List;
    SourceTable = UnknownTable61402;

    layout
    {
        area(content)
        {
            repeater(Control1102760000)
            {
                Editable = false;
                field("Patient No.";"Patient No.")
                {
                    ApplicationArea = Basic;
                }
                field("Date Registered";"Date Registered")
                {
                    ApplicationArea = Basic;
                }
                field("Patient Type";"Patient Type")
                {
                    ApplicationArea = Basic;
                }
                field("Student No.";"Student No.")
                {
                    ApplicationArea = Basic;
                }
                field("Employee No.";"Employee No.")
                {
                    ApplicationArea = Basic;
                }
                field("Relative No.";"Relative No.")
                {
                    ApplicationArea = Basic;
                }
                field(Title;Title)
                {
                    ApplicationArea = Basic;
                }
                field(Surname;Surname)
                {
                    ApplicationArea = Basic;
                }
                field("Middle Name";"Middle Name")
                {
                    ApplicationArea = Basic;
                }
                field("Last Name";"Last Name")
                {
                    ApplicationArea = Basic;
                }
                field(Gender;Gender)
                {
                    ApplicationArea = Basic;
                }
                field("Date Of Birth";"Date Of Birth")
                {
                    ApplicationArea = Basic;
                }
                field("Marital Status";"Marital Status")
                {
                    ApplicationArea = Basic;
                }
                field("ID Number";"ID Number")
                {
                    ApplicationArea = Basic;
                }
                field(Photo;Photo)
                {
                    ApplicationArea = Basic;
                }
                field("Correspondence Address 1";"Correspondence Address 1")
                {
                    ApplicationArea = Basic;
                }
                field("Correspondence Address 2";"Correspondence Address 2")
                {
                    ApplicationArea = Basic;
                }
                field("Correspondence Address 3";"Correspondence Address 3")
                {
                    ApplicationArea = Basic;
                }
                field("Telephone No. 1";"Telephone No. 1")
                {
                    ApplicationArea = Basic;
                }
                field("Telephone No. 2";"Telephone No. 2")
                {
                    ApplicationArea = Basic;
                }
                field(Email;Email)
                {
                    ApplicationArea = Basic;
                }
                field("Fax No.";"Fax No.")
                {
                    ApplicationArea = Basic;
                }
                field("Spouse Name";"Spouse Name")
                {
                    ApplicationArea = Basic;
                }
                field("Spouse Address 1";"Spouse Address 1")
                {
                    ApplicationArea = Basic;
                }
                field("Spouse Address 2";"Spouse Address 2")
                {
                    ApplicationArea = Basic;
                }
                field("Spouse Address 3";"Spouse Address 3")
                {
                    ApplicationArea = Basic;
                }
                field("Spouse Telephone No. 1";"Spouse Telephone No. 1")
                {
                    ApplicationArea = Basic;
                }
                field("Spouse Telephone No. 2";"Spouse Telephone No. 2")
                {
                    ApplicationArea = Basic;
                }
                field("Spouse Email";"Spouse Email")
                {
                    ApplicationArea = Basic;
                }
                field("Spouse Fax";"Spouse Fax")
                {
                    ApplicationArea = Basic;
                }
                field("Place of Birth Village";"Place of Birth Village")
                {
                    ApplicationArea = Basic;
                }
                field("Place of Birth Location";"Place of Birth Location")
                {
                    ApplicationArea = Basic;
                }
                field("Place of Birth District";"Place of Birth District")
                {
                    ApplicationArea = Basic;
                }
                field("Name of Chief";"Name of Chief")
                {
                    ApplicationArea = Basic;
                }
                field("Nearest Police Station";"Nearest Police Station")
                {
                    ApplicationArea = Basic;
                }
                field(Nationality;Nationality)
                {
                    ApplicationArea = Basic;
                }
                field(Religion;Religion)
                {
                    ApplicationArea = Basic;
                }
                field("Mother Alive or Dead";"Mother Alive or Dead")
                {
                    ApplicationArea = Basic;
                }
                field("Mother Full Name";"Mother Full Name")
                {
                    ApplicationArea = Basic;
                }
                field("Mother Occupation";"Mother Occupation")
                {
                    ApplicationArea = Basic;
                }
                field("Father Alive or Dead";"Father Alive or Dead")
                {
                    ApplicationArea = Basic;
                }
                field("Father Full Name";"Father Full Name")
                {
                    ApplicationArea = Basic;
                }
                field("Father Occupation";"Father Occupation")
                {
                    ApplicationArea = Basic;
                }
                field("Guardian Name";"Guardian Name")
                {
                    ApplicationArea = Basic;
                }
                field("Guardian Occupation";"Guardian Occupation")
                {
                    ApplicationArea = Basic;
                }
                field("Physical Impairment Details";"Physical Impairment Details")
                {
                    ApplicationArea = Basic;
                }
                field("Blood Group";"Blood Group")
                {
                    ApplicationArea = Basic;
                }
                field("Without Glasses R.6";"Without Glasses R.6")
                {
                    ApplicationArea = Basic;
                }
                field("Without Glasses L.6";"Without Glasses L.6")
                {
                    ApplicationArea = Basic;
                }
                field("With Glasses R.6";"With Glasses R.6")
                {
                    ApplicationArea = Basic;
                }
                field("With Glasses L.6";"With Glasses L.6")
                {
                    ApplicationArea = Basic;
                }
                field("Hearing Right Ear";"Hearing Right Ear")
                {
                    ApplicationArea = Basic;
                }
                field("Hearing Left Ear";"Hearing Left Ear")
                {
                    ApplicationArea = Basic;
                }
                field("Condition Of Teeth";"Condition Of Teeth")
                {
                    ApplicationArea = Basic;
                }
                field("Condition Of Throat";"Condition Of Throat")
                {
                    ApplicationArea = Basic;
                }
                field("Condition Of Ears";"Condition Of Ears")
                {
                    ApplicationArea = Basic;
                }
                field("Condition Of Lymphatic Glands";"Condition Of Lymphatic Glands")
                {
                    ApplicationArea = Basic;
                }
                field("Condition Of Nose";"Condition Of Nose")
                {
                    ApplicationArea = Basic;
                }
                field("Circulatory System Pulse";"Circulatory System Pulse")
                {
                    ApplicationArea = Basic;
                }
                field("Examining Officer";"Examining Officer")
                {
                    ApplicationArea = Basic;
                }
                field("Medical Exam Date";"Medical Exam Date")
                {
                    ApplicationArea = Basic;
                }
                field("Medical Details Not Covered";"Medical Details Not Covered")
                {
                    ApplicationArea = Basic;
                }
                field("Emergency Consent Relationship";"Emergency Consent Relationship")
                {
                    ApplicationArea = Basic;
                }
                field("Emergency Consent Full Name";"Emergency Consent Full Name")
                {
                    ApplicationArea = Basic;
                }
                field("Emergency Consent Address 1";"Emergency Consent Address 1")
                {
                    ApplicationArea = Basic;
                }
                field("Emergency Consent Address 2";"Emergency Consent Address 2")
                {
                    ApplicationArea = Basic;
                }
                field("Emergency Consent Address 3";"Emergency Consent Address 3")
                {
                    ApplicationArea = Basic;
                }
                field("Emergency Date of Consent";"Emergency Date of Consent")
                {
                    ApplicationArea = Basic;
                }
                field("Emergency National ID Card No.";"Emergency National ID Card No.")
                {
                    ApplicationArea = Basic;
                }
                field("Student Valid";"Student Valid")
                {
                    ApplicationArea = Basic;
                }
                field("Employee Valid";"Employee Valid")
                {
                    ApplicationArea = Basic;
                }
                field(Show;Show)
                {
                    ApplicationArea = Basic;
                }
            }
        }
    }

    actions
    {
        area(creation)
        {
            action(SyncRecs)
            {
                ApplicationArea = Basic;
                Caption = 'Sync Records';
                Image = SuggestWorkMachCost;
                Promoted = true;
                PromotedIsBig = true;

                trigger OnAction()
                var
                    HRMEmployeeC: Record UnknownRecord61188;
                    Customer: Record Customer;
                    HMISPatient: Record UnknownRecord61402;
                    HMSSetup: Record UnknownRecord61386;
                    NoSeriesManagement: Codeunit NoSeriesManagement;
                begin
                    if  Confirm('Sync Data?',true)=false then Error('Cancelled!');
                    HRMEmployeeC.Reset;
                    HRMEmployeeC.SetRange(Status,HRMEmployeeC.Status::Active);
                    if HRMEmployeeC.Find('-') then begin
                        repeat
                            begin
                              HMISPatient.Reset;
                              HMISPatient.SetRange("Patient No.",HRMEmployeeC."No.");
                              if HMISPatient.Find('-') then begin
                                  HMISPatient.Validate("Patient No.");
                                  HMISPatient."Employee No.":=HRMEmployeeC."No.";
                                  HMISPatient.Modify;
                                end else begin
                                  HMISPatient.Init;
                                  HMISPatient."Patient Type":=HMISPatient."patient type"::Employee;
                                  HMISPatient."Patient No.":=HRMEmployeeC."No.";
                                  HMISPatient."Employee No.":=HRMEmployeeC."No.";
                                  HMISPatient.Insert;
                                  HMISPatient.Validate("Patient No.");
                                HMISPatient.Modify;
                                  end;
                            end;
                          until HRMEmployeeC.Next=0;
                      end;
                    
                    Customer.Reset;
                    Customer.SetFilter(Status,'%1|%2',Customer.Status::Current,Customer.Status::Registration);
                    Customer.SetRange("Customer Posting Group",'STUDENT');
                    if Customer.Find('-') then begin
                        repeat
                            begin
                              HMISPatient.Reset;
                              HMISPatient.SetRange("Patient No.",Customer."No.");
                              HMISPatient.SetRange("Patient Type",HMISPatient."patient type"::Student);
                              if HMISPatient.Find('-') then begin
                                 HMISPatient.Validate("Patient No.");
                                HMISPatient.Surname:=Customer.Name;
                                if Customer.Gender=Customer.Gender::Female then
                                  HMISPatient.Gender:= HMISPatient.Gender::Female
                                else  if Customer.Gender=Customer.Gender::Male then
                                  HMISPatient.Gender:=HMISPatient.Gender::Male;
                                HMISPatient.Modify;
                                end else begin
                                  HMISPatient.Init;
                                  HMISPatient."Patient Type":=HMISPatient."patient type"::Student;
                                  HMISPatient."Patient No.":=Customer."No.";
                                HMISPatient.Surname:=Customer.Name;
                                if Customer.Gender=Customer.Gender::Female then
                                  HMISPatient.Gender:=HMISPatient.Gender::Female
                                else  if Customer.Gender=Customer.Gender::Male then
                                  HMISPatient.Gender:=HMISPatient.Gender::Male;
                                  HMISPatient.Insert(true);
                                  HMISPatient.Validate("Patient No.");
                                  end;
                            end;
                          until Customer.Next=0;
                      end;
                    // Sync Beneficiers & Dependants
                    HRMEmployeeBeneficiaries.Reset;
                    if HRMEmployeeBeneficiaries.Find('-') then begin
                        repeat
                            begin
                    //        IF HRMEmployeeBeneficiaries."Employee Code"='0366' THEN
                    //          HMISPatient.RESET;
                              HMISPatient.Reset;
                              HMISPatient.SetRange(Surname,HRMEmployeeBeneficiaries.SurName);
                              HMISPatient.SetRange("Last Name",HRMEmployeeBeneficiaries."Other Names");
                              HMISPatient.SetRange("Employee No.",HRMEmployeeBeneficiaries."Employee Code");
                              if HMISPatient.Find('-') then begin
                                  HMISPatient."Patient Type":=HMISPatient."patient type"::Dependant;
                                  HMISPatient."Employee No.":=HRMEmployeeBeneficiaries."Employee Code";
                                  HMISPatient."ID Number":=HRMEmployeeBeneficiaries."ID No/Passport No";
                                  HMISPatient."Date Of Birth":=HRMEmployeeBeneficiaries."Date Of Birth";
                                  HMISPatient.Surname:=HRMEmployeeBeneficiaries.SurName;
                                  HMISPatient."Last Name":=HRMEmployeeBeneficiaries."Other Names";
                                  HMISPatient.Registered:=true;
                                  HMISPatient.Modify;
                                end else begin
                                 HMSSetup.Get;
                                 HMSSetup.TestField("Patient Nos");
                                  HMISPatient.Init;
                                  HMISPatient."Patient Type":=HMISPatient."patient type"::Dependant;
                                  HMISPatient."Patient No.":=NoSeriesManagement.GetNextNo(HMSSetup."Patient Nos",Today,true);
                                  HMISPatient."Employee No.":=HRMEmployeeBeneficiaries."Employee Code";
                                  HMISPatient."Date Registered":=Today;
                                  HMISPatient."ID Number":=HRMEmployeeBeneficiaries."ID No/Passport No";
                                  HMISPatient."Date Of Birth":=HRMEmployeeBeneficiaries."Date Of Birth";
                                  HMISPatient.Surname:=HRMEmployeeBeneficiaries.SurName;
                                  HMISPatient."Last Name":=HRMEmployeeBeneficiaries."Other Names";
                                  HMISPatient."Depandant Principle Member":=HRMEmployeeBeneficiaries."Employee Code";
                                  HMISPatient.Registered:=true;
                                  HMISPatient.Insert(true);
                                  end;
                            end;
                          until HRMEmployeeBeneficiaries.Next=0;
                      end;
                      /*HRMEmployeeKin.RESET;
                    IF HRMEmployeeKin.FIND('-') THEN BEGIN
                        REPEAT
                            BEGIN
                              HMISPatient.RESET;
                              HMISPatient.SETRANGE("Patient No.",HRMEmployeeKin."ID No/Passport No");
                              IF HMISPatient.FIND('-') THEN BEGIN
                                 HMISPatient.VALIDATE("Patient No.");
                                HMISPatient.MODIFY;
                                END ELSE BEGIN
                                  HMISPatient.INIT;
                                  HMISPatient."Patient Type":=HMISPatient."Patient Type"::Dependant;
                                  HMISPatient."Patient No.":=HRMEmployeeKin."ID No/Passport No";
                                  HMISPatient.INSERT;
                                  //HMISPatient.VALIDATE("Patient Type");
                                  HMISPatient.VALIDATE("Patient No.");
                                HMISPatient.MODIFY;
                                  END;
                            END;
                          UNTIL HRMEmployeeKin.NEXT=0;
                      END;*/
                    CurrPage.Update;

                end;
            }
        }
    }

    trigger OnAfterGetRecord()
    var
        Patient: Record UnknownRecord61402;
    begin
    end;

    trigger OnInit()
    begin
        CurrPage.LookupMode := true;
    end;

    trigger OnOpenPage()
    var
        Cust: Record Customer;
        Empl: Record UnknownRecord61118;
    begin
          FilterGroup(2);
          SetRange(Show,true);
        Patient.Reset;
        Patient.SetAutocalcFields("Employee Valid");
        Patient.SetRange("Employee Valid",true);
        Patient.SetRange(Show,false);
        if Patient.FindSet then
          Patient.ModifyAll(Show,true);
        Patient.Reset;
        Patient.SetAutocalcFields("Student Valid");
        Patient.SetRange("Student Valid",true);
        Patient.SetRange(Show,false);
        if Patient.FindSet then
          Patient.ModifyAll(Show,true);

        Patient.Reset;
        Patient.SetRange(Show,true);
        Patient.SetAutocalcFields("Student Valid");
        Patient.SetRange("Student Valid",true);
        Patient.SetRange("Student No.",'');
        if Patient.FindSet then begin
          repeat
          Cust.Reset;
          Cust.SetRange("No.",Patient."Patient No.");
          if Cust.FindFirst then begin
            Patient."Student No.":=Cust."No.";
            Patient.Modify();
            end;
            until Patient.Next=0;
          end;

        Patient.Reset;
        Patient.SetAutocalcFields("Depedant Valid");
        Patient.SetRange("Depedant Valid",true);
        Patient.SetRange("Patient Type",Patient."patient type"::Dependant);
        Patient.SetRange(Show,false);
        if Patient.FindSet then
          Patient.ModifyAll(Show,true);
    end;

    var
        HRMEmployeeBeneficiaries: Record UnknownRecord61324;
        FiltersLoaded: Boolean;
        Patient: Record UnknownRecord61402;
}

